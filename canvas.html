<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MegaPython â€” Collaborative Canvas</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');
    
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #0a220a;
      color: #e2e8f0;
      overflow-x: hidden;
      background-image: 
        radial-gradient(circle at 20% 30%, rgba(34, 139, 34, 0.1) 0%, transparent 40%),
        radial-gradient(circle at 80% 70%, rgba(34, 139, 34, 0.1) 0%, transparent 40%);
    }
    
    .pixel-font {
      font-family: 'Press Start 2P', cursive;
    }
    
    .jungle-glow {
      text-shadow: 0 0 10px rgba(74, 158, 74, 0.7);
    }
    
    .pixel-card {
      background: #1e3e1e;
      border: 4px solid #4a9e4a;
      box-shadow: 0 0 0 2px #0f2a0f, 0 0 0 6px #4a9e4a, 0 0 15px rgba(74, 158, 74, 0.5);
      transition: all 0.3s ease;
    }
    
    .pixel-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 0 0 2px #0f2a0f, 0 0 0 6px #4a9e4a, 0 0 25px rgba(74, 158, 74, 0.8);
    }
    
    .pixel-button {
      background: #4a9e4a;
      color: #0f172a;
      border: 2px solid #0f2a0f;
      box-shadow: 0 4px 0 #0f2a0f;
      transition: all 0.1s ease;
      font-family: 'Press Start 2P', cursive;
      font-size: 0.7rem;
    }
    
    .pixel-button:hover {
      transform: translateY(2px);
      box-shadow: 0 2px 0 #0f2a0f;
    }
    
    .jungle-leaf {
      position: absolute;
      width: 40px;
      height: 40px;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 40 40'%3E%3Cpath fill='%234a9e4a' d='M20,5 C10,5 5,15 5,25 5,35 15,35 20,35 C25,35 35,35 35,25 35,15 30,5 20,5 Z'/%3E%3C/svg%3E");
      background-repeat: no-repeat;
      z-index: 0;
      opacity: 0.3;
    }
    
    .social-link {
      color: #a3e635;
      transition: color 0.3s;
    }
    
    .social-link:hover {
      color: #4ade80;
    }
    
    .canvas-container {
      position: relative;
      overflow: auto;
      max-width: 100%;
      margin: 0 auto;
      border: 4px solid #4a9e4a;
      border-radius: 12px;
      background: #1e3e1e;
      box-shadow: 0 0 0 2px #0f2a0f, 0 0 0 6px #4a9e4a, 0 0 15px rgba(74, 158, 74, 0.5);
    }
    
    #pixelCanvas {
      image-rendering: pixelated;
      display: block;
      margin: 0 auto;
    }
    
    .color-swatch {
      width: 30px;
      height: 30px;
      border: 2px solid #0f2a0f;
      border-radius: 4px;
      cursor: pointer;
      transition: all 0.2s;
    }
    
    .color-swatch:hover {
      transform: scale(1.1);
    }
    
    .color-swatch.selected {
      border: 2px solid #a3e635;
      box-shadow: 0 0 8px #a3e635;
    }
    
    .cooldown-overlay {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(10, 34, 10, 0.8);
      display: flex;
      align-items: center;
      justify-content: center;
      color: #a3e635;
      font-size: 1.5rem;
      z-index: 10;
      border-radius: 8px;
    }
    
    .user-count {
      background: #4a9e4a;
      color: #0f172a;
      padding: 4px 8px;
      border-radius: 12px;
      font-size: 0.8rem;
    }
    
    .archive-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
      gap: 1rem;
      margin-top: 1rem;
    }
    
    .archive-item {
      background: rgba(42, 74, 42, 0.7);
      border-radius: 8px;
      padding: 0.5rem;
      text-align: center;
      transition: all 0.3s;
    }
    
    .archive-item:hover {
      transform: translateY(-3px);
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
    }
  </style>
</head>
<body class="min-h-screen">
  <!-- Jungle leaves decoration -->
  <div class="jungle-leaf" style="top: 10%; left: 5%;"></div>
  <div class="jungle-leaf" style="top: 15%; right: 7%; transform: rotate(45deg);"></div>
  <div class="jungle-leaf" style="top: 40%; left: 8%; transform: rotate(80deg);"></div>
  <div class="jungle-leaf" style="bottom: 20%; right: 10%; transform: rotate(120deg);"></div>
  <div class="jungle-leaf" style="bottom: 30%; left: 12%; transform: rotate(160deg);"></div>

  <div class="relative z-10 max-w-6xl mx-auto p-6">
    <header class="flex justify-between items-center mb-12">
      <h1 class="text-3xl pixel-font text-green-500 jungle-glow">MegaPython</h1>
      <nav class="flex gap-4 items-center">
        <a href="/" class="text-green-300 hover:text-green-500 transition-colors">Home</a>
        <a href="/rarity.html" class="text-green-300 hover:text-green-500 transition-colors">Rarity Checker</a>
        <a href="/megagenerate.html" class="text-green-300 hover:text-green-500 transition-colors">MegaGenerate</a>
      </nav>
    </header>

    <section class="text-center mb-12">
      <h2 class="text-4xl pixel-font text-green-400 mb-4 jungle-glow">Collaborative Pixel Canvas</h2>
      <p class="text-lg text-gray-400 max-w-2xl mx-auto">
        Place a pixel every 5 seconds and create art together with the MegaPython community! The canvas resets every week, and previous artwork is archived.
      </p>
    </section>

    <div class="pixel-card p-6 mb-8">
      <div class="flex justify-between items-center mb-6">
        <div class="flex items-center gap-4">
          <span class="text-green-300 pixel-font">Online: </span>
          <span class="user-count pixel-font" id="userCount">0</span>
        </div>
        <div class="flex items-center gap-4">
          <span class="text-green-300 pixel-font">Time until reset: </span>
          <span class="user-count pixel-font" id="resetTimer">7 days</span>
        </div>
      </div>

      <div class="canvas-container mb-6">
        <canvas id="pixelCanvas" width="64" height="64"></canvas>
        <div class="cooldown-overlay hidden" id="cooldownOverlay">
          <div class="text-center">
            <div class="pixel-font mb-2" id="cooldownTimer">5s</div>
            <div class="text-sm">Until next pixel</div>
          </div>
        </div>
      </div>

      <div class="mb-6">
        <h3 class="text-xl pixel-font text-green-400 mb-4 text-center">Color Palette</h3>
        <div class="flex flex-wrap justify-center gap-2">
          <div class="color-swatch selected" style="background-color: #1e3e1e;" data-color="#1e3e1e"></div>
          <div class="color-swatch" style="background-color: #4a9e4a;" data-color="#4a9e4a"></div>
          <div class="color-swatch" style="background-color: #0f2a0f;" data-color="#0f2a0f"></div>
          <div class="color-swatch" style="background-color: #58ffa8;" data-color="#58ffa8"></div>
          <div class="color-swatch" style="background-color: #3a7d3a;" data-color="#3a7d3a"></div>
          <div class="color-swatch" style="background-color: #2a4a2a;" data-color="#2a4a2a"></div>
          <div class="color-swatch" style="background-color: #a3e635;" data-color="#a3e635"></div>
          <div class="color-swatch" style="background-color: #4ade80;" data-color="#4ade80"></div>
          <div class="color-swatch" style="background-color: #22c55e;" data-color="#22c55e"></div>
          <div class="color-swatch" style="background-color: #16a34a;" data-color="#16a34a"></div>
          <div class="color-swatch" style="background-color: #15803d;" data-color="#15803d"></div>
          <div class="color-swatch" style="background-color: #166534;" data-color="#166534"></div>
          <div class="color-swatch" style="background-color: #14532d;" data-color="#14532d"></div>
          <div class="color-swatch" style="background-color: #064e3b;" data-color="#064e3b"></div>
          <div class="color-swatch" style="background-color: #000000;" data-color="#000000"></div>
          <div class="color-swatch" style="background-color: #ffffff;" data-color="#ffffff"></div>
          <div class="color-swatch" style="background-color: #ff0000;" data-color="#ff0000"></div>
          <div class="color-swatch" style="background-color: #00ff00;" data-color="#00ff00"></div>
          <div class="color-swatch" style="background-color: #0000ff;" data-color="#0000ff"></div>
          <div class="color-swatch" style="background-color: #ffff00;" data-color="#ffff00"></div>
          <div class="color-swatch" style="background-color: #ff00ff;" data-color="#ff00ff"></div>
          <div class="color-swatch" style="background-color: #00ffff;" data-color="#00ffff"></div>
        </div>
      </div>

      <div class="text-center">
        <button id="downloadBtn" class="pixel-button px-6 py-3 font-bold pixel-font mb-4">Download Current Canvas</button>
        <p class="text-gray-400 text-sm">Right-click on the canvas and "Save Image" for a quick download</p>
      </div>
    </div>

    <section class="pixel-card p-6 mb-12">
      <h2 class="text-3xl pixel-font text-green-400 mb-6 text-center jungle-glow">Previous Art Archives</h2>
      <div class="archive-grid" id="archiveGrid">
        <div class="archive-item">
          <div class="text-gray-400 text-sm mb-2">Week 32, 2025</div>
          <img src="https://via.placeholder.com/150/1e3e1e/4a9e4a?text=No+Archives+Yet" alt="Archive placeholder" class="rounded mb-2 mx-auto">
          <button class="pixel-button px-3 py-1 text-xs">Download</button>
        </div>
      </div>
    </section>

    <footer class="text-center text-gray-500 mt-12">
      <div class="flex justify-center gap-8 mb-6">
        <a href="https://x.com/megapythons" class="social-link pixel-font">X</a>
        <a href="https://megapython.testnet.nfts2.me/" class="social-link pixel-font">Mint</a>
        <a href="https://linktr.ee/megaPython" class="social-link pixel-font">Linktree</a>
        <a href="https://rarible.fun/megaethtestnet/collections/0xf4c6cc08f7bba6867119f2e8f9556961a76f7098" class="social-link pixel-font">Rarible.Fun</a>
      </div>
      <p class="mb-4">&copy; 2025 MegaPython. All rights reserved.</p>
    </footer>
  </div>

  <script>
    // Configuration
    const PIXEL_SIZE = 10; // Size of each pixel on screen
    const CANVAS_WIDTH = 64; // Number of pixels wide
    const CANVAS_HEIGHT = 64; // Number of pixels tall
    const COOLDOWN_TIME = 5000; // 5 seconds cooldown between placing pixels

    // Elements
    const canvas = document.getElementById('pixelCanvas');
    const ctx = canvas.getContext('2d');
    const cooldownOverlay = document.getElementById('cooldownOverlay');
    const cooldownTimer = document.getElementById('cooldownTimer');
    const userCount = document.getElementById('userCount');
    const resetTimer = document.getElementById('resetTimer');
    const downloadBtn = document.getElementById('downloadBtn');
    const colorSwatches = document.querySelectorAll('.color-swatch');
    
    // State
    let selectedColor = '#1e3e1e';
    let cooldownActive = false;
    let cooldownEndTime = 0;
    let pixels = {};
    let usersOnline = 0;

    // Set canvas size based on pixel dimensions
    canvas.width = CANVAS_WIDTH;
    canvas.height = CANVAS_HEIGHT;
    canvas.style.width = `${CANVAS_WIDTH * PIXEL_SIZE}px`;
    canvas.style.height = `${CANVAS_HEIGHT * PIXEL_SIZE}px`;

    // Initialize canvas with background color
    function initializeCanvas() {
      ctx.fillStyle = '#1e3e1e';
      ctx.fillRect(0, 0, CANVAS_WIDTH, CANVAS_HEIGHT);
      
      // Load saved pixels from localStorage
      const savedPixels = localStorage.getItem('megapython_canvas');
      if (savedPixels) {
        pixels = JSON.parse(savedPixels);
        renderPixels();
      }
      
      // Load user count (simulated)
      usersOnline = Math.floor(Math.random() * 50) + 10;
      userCount.textContent = usersOnline;
      
      // Set up weekly reset timer (simulated)
      updateResetTimer();
    }

    // Render all pixels on the canvas
    function renderPixels() {
      for (const [key, color] of Object.entries(pixels)) {
        const [x, y] = key.split(',').map(Number);
        ctx.fillStyle = color;
        ctx.fillRect(x, y, 1, 1);
      }
    }

    // Place a pixel at the specified coordinates
    function placePixel(x, y) {
      if (cooldownActive) return;
      
      // Convert mouse coordinates to canvas coordinates
      const rect = canvas.getBoundingClientRect();
      const pixelX = Math.floor((x - rect.left) / PIXEL_SIZE);
      const pixelY = Math.floor((y - rect.top) / PIXEL_SIZE);
      
      // Ensure coordinates are within bounds
      if (pixelX < 0 || pixelX >= CANVAS_WIDTH || pixelY < 0 || pixelY >= CANVAS_HEIGHT) return;
      
      // Update the pixel
      pixels[`${pixelX},${pixelY}`] = selectedColor;
      ctx.fillStyle = selectedColor;
      ctx.fillRect(pixelX, pixelY, 1, 1);
      
      // Save to localStorage
      localStorage.setItem('megapython_canvas', JSON.stringify(pixels));
      
      // Start cooldown
      startCooldown();
      
      // Simulate other users placing pixels
      simulateOtherUsers();
    }

    // Start the cooldown period
    function startCooldown() {
      cooldownActive = true;
      cooldownEndTime = Date.now() + COOLDOWN_TIME;
      cooldownOverlay.classList.remove('hidden');
      
      // Update cooldown timer
      const interval = setInterval(() => {
        const timeLeft = cooldownEndTime - Date.now();
        
        if (timeLeft <= 0) {
          clearInterval(interval);
          cooldownOverlay.classList.add('hidden');
          cooldownActive = false;
          return;
        }
        
        cooldownTimer.textContent = `${Math.ceil(timeLeft / 1000)}s`;
      }, 100);
    }

    // Simulate other users placing pixels (for demo purposes)
    function simulateOtherUsers() {
      // Only simulate if we have users online
      if (usersOnline > 0) {
        // Random number of actions based on user count
        const actions = Math.min(usersOnline, Math.floor(Math.random() * 5) + 1);
        
        for (let i = 0; i < actions; i++) {
          setTimeout(() => {
            const x = Math.floor(Math.random() * CANVAS_WIDTH);
            const y = Math.floor(Math.random() * CANVAS_HEIGHT);
            
            // Select a random color from the palette
            const randomColor = colorSwatches[Math.floor(Math.random() * colorSwatches.length)].dataset.color;
            
            // Update the pixel
            pixels[`${x},${y}`] = randomColor;
            ctx.fillStyle = randomColor;
            ctx.fillRect(x, y, 1, 1);
            
            // Save to localStorage
            localStorage.setItem('megapython_canvas', JSON.stringify(pixels));
          }, Math.random() * 2000); // Random delay up to 2 seconds
        }
      }
    }

    // Update the reset timer display
    function updateResetTimer() {
      // For demo purposes, we'll set a random time between 2-7 days
      const days = Math.floor(Math.random() * 6) + 2;
      const hours = Math.floor(Math.random() * 24);
      const minutes = Math.floor(Math.random() * 60);
      
      resetTimer.textContent = `${days}d ${hours}h ${minutes}m`;
    }

    // Download the current canvas as an image
    function downloadCanvas() {
      const link = document.createElement('a');
      link.download = `megapython-canvas-${new Date().toISOString().slice(0, 10)}.png`;
      link.href = canvas.toDataURL('image/png');
      link.click();
    }

    // Event listeners
    canvas.addEventListener('click', (e) => {
      placePixel(e.clientX, e.clientY);
    });

    canvas.addEventListener('mousemove', (e) => {
      if (cooldownActive) return;
      
      // Show preview of where pixel would be placed
      const rect = canvas.getBoundingClientRect();
      const pixelX = Math.floor((e.clientX - rect.left) / PIXEL_SIZE);
      const pixelY = Math.floor((e.clientY - rect.top) / PIXEL_SIZE);
      
      if (pixelX >= 0 && pixelX < CANVAS_WIDTH && pixelY >= 0 && pixelY < CANVAS_HEIGHT) {
        canvas.style.cursor = 'pointer';
      } else {
        canvas.style.cursor = 'default';
      }
    });

    colorSwatches.forEach(swatch => {
      swatch.addEventListener('click', () => {
        document.querySelector('.color-swatch.selected')?.classList.remove('selected');
        swatch.classList.add('selected');
        selectedColor = swatch.dataset.color;
      });
    });

    downloadBtn.addEventListener('click', downloadCanvas);

    // Initialize the canvas
    initializeCanvas();

    // Simulate user count changes
    setInterval(() => {
      const change = Math.floor(Math.random() * 5) - 2; // -2 to +2
      usersOnline = Math.max(5, usersOnline + change);
      userCount.textContent = usersOnline;
    }, 10000);
  </script>
</body>
</html>
